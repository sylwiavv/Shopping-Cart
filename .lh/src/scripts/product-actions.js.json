{
    "sourceFile": "src/scripts/product-actions.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1636488008688,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1636488167783,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -137,9 +137,9 @@\n      }\n      document.querySelectorAll('#total-price')[0].innerHTML = '$' + total;\n \n      const test = cartItems.reduce((acc, item) => {\n-       return acc += item.price;\n+       return acc += item;\n      });\n \n      console.log(test);\n \n"
                },
                {
                    "date": 1636488199792,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -136,14 +136,8 @@\n        total = total + (price * qty);\n      }\n      document.querySelectorAll('#total-price')[0].innerHTML = '$' + total;\n \n-     const test = cartItems.reduce((acc, item) => {\n-       return acc += item;\n-     });\n-\n-     console.log(test);\n-\n    } else if (cartItems.length === 0) {\n      document.querySelectorAll('#total-price')[0].innerHTML = '$' + 0;\n    }\n }\n"
                }
            ],
            "date": 1636488008688,
            "name": "Commit-0",
            "content": "const body = document.body;\nconst addToCartButtons = document.querySelectorAll('.add-to-cart');\nconst productList = document.querySelectorAll('.products-list-container');\nconst mainProductsList = document.querySelector('#main-products-list');\nconst cartIcon = document.querySelector('.cart-icon');\nconst amountCart = document.querySelector('#cart-product-number');\nlet cartArray = [];\nlet timer;\n\n// LOCAL STORAGE\nconst productsFromLocalStorage = JSON.parse(localStorage.getItem(\"myLocalCartProducts\"));\n\n// ADD CLICK\naddToCartButtons.forEach(addButton => {\n  addButton.addEventListener('click', (event) => {\n    const addButtonClicked = event.target;\n    const parentButtonClicked = addButtonClicked.parentElement.parentElement;\n    let productId = parentButtonClicked.dataset.productId;\n    let productQty = parentButtonClicked.querySelector('.product-information__qty').value;\n    let productTitle = parentButtonClicked.querySelector('.product-information__title').textContent;\n    productQty = parseInt(productQty);\n\n    if (isNaN(productQty) || productQty <= 0 || typeof productQty === 'string') {\n      productQty = 1;\n    } else {\n      productQty = productQty;\n    }\n\n    const cartItem = cartArray.filter(item => {\n        return item.Id === productId;\n    });\n\n    if (!cartItem.length) {\n      cartArray.push({\n        Id: productId,\n        Qty: productQty\n      });\n\n    } else {\n      cartItem[0].Qty = productQty + cartItem[0].Qty;\n    }\n\n    let modalContainer = document.createElement('div');\n    modalContainer.setAttribute('class', 'add-to-cart-modal');\n    modalContainer.innerHTML = \"<p>Dodano produkt\" + \" \" + `${productTitle}` + \"</p>\";\n    let oldTimer = timer;\n\n    timer = window.setTimeout(() => modalContainer.classList.add('list-leave-active'), 3000);\n    window.setTimeout(() => document.querySelector('.list-leave-active').remove(), 5000);\n\n    let getModalContainer = parentButtonClicked.querySelector('.add-to-cart-modal');\n    let getImageContainer = parentButtonClicked.querySelector('.product__image-container').cloneNode(true);\n\n    if (getModalContainer == undefined) {\n      body.appendChild(modalContainer);\n      modalContainer.prepend(getImageContainer);\n    } else {\n      window.clearTimeout(oldTimer);\n      getModalContainer.innerHTML = \"<p>Dodano kolejną  sztukę\" + \" \" + `${productTitle}` + \"</p>\";\n    }\n\n    cartIcon.classList.add('shake');\n    setTimeout(() => cartIcon.classList.remove('shake'), 500);\n\n    renderCart();\n    updateNumberInCart();\n  });\n});\n\n// Render products in cart\nconst renderCart = () => {\n  let products = cartArray.map((cartItem) => {\n    let product = productsArray.filter(obj => {\n      return cartItem.Id === obj.Sku;\n    })[0];\n    product.Qty = cartItem.Qty;\n    return product;\n  });\n\n  renderCartProducts(products);\n  removeCartProduct();\n  updateQtyValueInCart();\n  totalCartPrice();\n\n  let cartInputs = document.querySelectorAll('.cart_qty');\n  cartInputs.forEach(cartInput => {\n      cartInput.disabled = true;\n  });\n  localStorage.setItem(\"myLocalCartProducts\", JSON.stringify(cartArray));\n}\n\n// Removing product from cart\nconst removeCartProduct = () => {\n  const removeButtons = document.querySelectorAll('.remove-from-cart');\n  removeButtons.forEach(removeButton => {\n    removeButton.addEventListener('click', (event) => {\n      const parentButtonClicked = removeButton.parentElement.parentElement;\n      let productId = parentButtonClicked.dataset.productId;\n      let productToRemove = '';\n\n      productToRemove = cartArray.find(function(item) {\n        return item.Id === productId;\n      });\n\n      let index = cartArray.indexOf(productToRemove);\n      cartArray.splice(index,1);\n\n      updateNumberInCart();\n      renderCart();\n    })\n  });\n}\n\nconst updateNumberInCart = () => {\n  const cartIsEmpty = document.querySelector('.cart-information');\n  amountCart.innerHTML = cartArray.length;\n\n  let textA = \"Twój koszyk jest pusty\";\n  let textB = \"\";\n  cartIsEmpty.innerHTML = (cartArray.length == 0) ? textA : textB;\n  cartArray.length == 0 ? cartIsEmpty.classList.add('empty') : cartIsEmpty.classList.remove('empty');\n}\n\n//Total cart price\nconst totalCartPrice = () => {\n  const cartItems = document.querySelectorAll('#main-products-cart-list > .product');\n  if ( cartItems.length ) {\n    let total = 0;\n     for (let i = 0; i < cartItems.length; i++) {\n       let prodCart = cartItems[i];\n       let prodCartPrice = prodCart.querySelectorAll('.product-information__price')[0];\n       let price = parseFloat(prodCartPrice.innerText.replace('$', ''));\n       let prodCartQty = prodCart.querySelectorAll('.product-information__qty')[0];\n       let qty = prodCartQty.value;\n       qty = parseInt(qty, 10);\n       total = total + (price * qty);\n     }\n     document.querySelectorAll('#total-price')[0].innerHTML = '$' + total;\n\n     const test = cartItems.reduce((acc, item) => {\n       return acc += item.price;\n     });\n\n     console.log(test);\n\n   } else if (cartItems.length === 0) {\n     document.querySelectorAll('#total-price')[0].innerHTML = '$' + 0;\n   }\n}\n\nconst parent = document.querySelector('.minicart-wrapper');\nconst child = document.querySelector('#cart-list');\nconst closeMinicartBtn = document.querySelector('#close-minicart');\n\nparent.addEventListener('click', (e) => {\n   if(e.target === e.currentTarget) {\n     parent.classList.toggle('active');\n     body.classList.toggle('not-scroll');\n   }\n});\n\nbody.addEventListener('click', (e) => {\n   if(e.target == e.currentTarget && body.classList.contains('not-scroll')) {\n     body.classList.remove('not-scroll');\n     parent.classList.remove('active');\n   }\n});\n\n//TODO\ncloseMinicartBtn.addEventListener('click', (e) => {\n   if(e.target == e.currentTarget && body.classList.contains('not-scroll')) {\n     body.classList.remove('not-scroll');\n     parent.classList.remove('active');\n   }\n});\n\nconst updateCartProductQty = (productId, itemQty) => {\n  let productCart = cartArray.filter(item => {\n    return item.Id === productId;\n  })[0];\n  productCart.Qty = itemQty;\n}\n\nconst updateQtyValueInCart = () => {\n const increase = document.querySelectorAll('.increase');\n const decrease = document.querySelectorAll('.decrease');\n\n  increase.forEach((increaseButton) => {\n    increaseButton.addEventListener('click', (e) => {\n        const clickedButton = event.target;\n        let input = e.target.parentNode.querySelector('.cart_qty');\n        let parentButtonClicked = clickedButton.parentElement.parentElement.parentElement.parentElement;\n        let productId = parentButtonClicked.dataset.productId;\n        input = parseInt(input.value, 10);\n        input = isNaN(input) ? 0 : input;\n        input++;\n\n        e.target.parentNode.querySelector('.cart_qty').value = input;\n        totalCartPrice();\n        updateCartProductQty(productId, input);\n    });\n  });\n\n  decrease.forEach((decreaseButton) => {\n    decreaseButton.addEventListener('click', (e) => {\n        const clickedButton = event.target;\n        let input = e.target.parentNode.querySelector('.cart_qty');\n        let parentButtonClicked = clickedButton.parentElement.parentElement.parentElement.parentElement;\n        let productId = parentButtonClicked.dataset.productId;\n        input = parseInt(input.value, 10);\n        input = isNaN(input) ? 0 : input;\n        input < 1 ? input = 1 : '';\n        input--;\n        e.target.parentNode.querySelector('.cart_qty').value = input;\n        totalCartPrice();\n        updateCartProductQty(productId, input);\n    });\n  });\n}\n\nif (productsFromLocalStorage) {\n  cartArray = productsFromLocalStorage;\n\n  updateNumberInCart();\n  renderCart();\n}"
        }
    ]
}